% -*- coding: UTF-8; -*-
\documentclass[11pt,onecolumn]{article}
%Pour langue et caractères spéciaux
\usepackage[french]{babel} 
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[latin1]{inputenc}

\usepackage[top=2cm, bottom=2cm, left=2cm, right=2cm, columnsep=20pt]{geometry}   %Pour ajuster les marges
\usepackage{graphicx}      %pour inclure des graphiques
\usepackage{url}           %Pour inclure des adresse web
\usepackage{verbatim}      %pour inclure les codes en annexe, on utilisera la commande verbatim
\usepackage{amsmath}
\usepackage{mathrsfs}
\usepackage{amssymb}
\usepackage{xfrac}
\usepackage{float}
\usepackage{wrapfig}
\usepackage{subcaption}
\usepackage{listings}
\lstset{
basicstyle=\small\ttfamily,
columns=flexible,
breaklines=true
}

\renewcommand{\baselinestretch}{1.5} 

\begin{document}

%Page titre
\begin{titlepage}
\center

\vspace*{2cm}

\textsc{\LARGE Université de Montréal}\\[1cm] 
\textsc{\Large PHY 3075 -- Modélisation numérique en physique}\\[1.5cm] 

\rule{\linewidth}{0.5mm} \\[0.5cm]
{\LARGE \bfseries Projet 2 - Barrière de confinement plasma} \\[0.2cm] % Titre page titre
\rule{\linewidth}{0.5mm} \\[3cm]

\large par: \\*
Patrice Béchard\\*
20019173\\[8cm] 


{\large \today}\\[3cm]

\vfill
\end{titlepage}

\section{Introduction}

La fusion nucléaire est souvent vue comme la solution miracle aux problèmes énergétiques de la planète. Il est possible de fusionner un noyau de deutérium ($^2H$) avec un noyau de tritium ($^3H$)pour produire de l'énergie, et ce, en laissant comme produit un noyau d'hélium et un neutron, qui sont des déchets propres. Sa mise en application au niveau pratique est compliquée par le fait qu'il faut amener les atomes à de très grandes températures pour que le processus de fusion se produise, températures auxquelles aucun matériau connu ne peut supporter sans fondre. Il est cependant possible de confiner le plasma d'hydrogène qui réagit dans une partie du réacteur utilisé à l'aide de champs magnétiques de sorte que les parois ne soient pas exposés à ces grandes températures.

Le but de ce projet est de modéliser numériquement le confinement de plasma en tokamak (chambre magnétique toroïdale), phénomène faisant appel à la résolution d'équation différentielles partielles (EDP) de type \textit{diffusion}. La méthode de résolution d'EDP utilisée est la méthode de Crank-Nicolson, algorithme implicite demandant la résolution d'un système tridiagonal d'équation linéaires. Les détails de l'implémentation de l'algorithme sont présentés dans les notes de cours \cite{notes_chap_2}. 

Une validation du code utilisé pour modéliser le système sera tout d'abord présenté, et suivra ensuite une présentation des résultats issus d'une exploration numérique de divers phénomènes et de leur effet sur la barrière de confinement plasma. Une version du code ainsi que des figures en pleine résolution et en couleur contenues dans ce rapport sont disponible sur le dépot électronique situé à l'adresse suivante : \url{https://goo.gl/mPOaI6}



\section{Validation du code}\label{sec:validation}

Pour valider le programme construit, les figures 2.15, 2.16 et 2.17 des notes de cours ont été répliquées\cite{notes_chap_2}. Tout d'abord, la figure \ref{fig:2.15} présente la variation du flux de chaleur en fonction du gradient de température pour différentes valeurs de coefficient $\chi_1$ associé au transport turbulent.

\begin{figure}[p]
\center
\includegraphics[scale=0.73]{figures/verif_fig_215_save.png}
\caption{\small{Variation du flux de chaleur en fonction du gradient de température dans le cas d?un transport turbulent en 1D.}}
\label{fig:2.15}
\end{figure}

La figure produite par le programme est identique à la figure 2.15 des notes de cours, signe que notre programme sait bien répliquer cette partie de l'analyse. Plus la constante $\chi_1$ devient grande par rapport à $\chi_0$, plus la relation entre la variation du flux de chaleur et le gradient de température non-monotone.

La seconde figure ayant été répliquée est la figure 2.16 des notes de cours, présentée à la figure \ref{fig:2.16} du présent document. Elle présente l'évolution dans le temps du profil de température sur le domaine spatial allant de -10 à 10. Les différentes courbes tracées représentent plusieurs temps distincts, soit aux temps 0.05, 0.1, 0.25, 0.5, 1.0, 2.5, 5.0, 10.0, 25.0 (allant du bas vers le haut).

\begin{figure}[p]
\center
\includegraphics[scale=0.73]{figures/verif_fig_216_save.png}
\caption{\small{Évolution du profil de température pour une solution de l'éq. (2.112) des notes de cours avec valeurs de paramètres $\chi_0=1$, $\chi_1=8$, $\alpha=1$, $\beta=4$ et $H_0 =14.4$. Le trait en tirets montre le profil Gaussien du terme source. Cette solution numérique par Crank-Nicolson utilise des pas $\Delta x = 0.02$ et $\Delta t = 5\times 10^{-4}$.}}
\label{fig:2.16}
\end{figure}

Encore une fois, la figure répliquée est identique à l'originale, signe que le programme fonctionne comme voulu. Il est possible de voir deux discontinuités de part et d'autre du centre du domaine, soit une au sommet et une autre lorsque le profil de température descend vers de faibles valeurs. C'est le bris de pente près du centre qui est à l'origine de l'établissement de la barrière de confinement. 

La dernière figure à répliquer pour compléter la validation du code est la figure 2.17 des notes de cours, qui est présentée à a figure \ref{fig:2.17} de ce rapport. Elle montre le comportement du gradient de température $dT(x,t)/dx$ ainsi que de la conductivité thermique totale $\chi(x,t)$ sur une partie du domaine pour les mêmes temps qu'à la figure précédente. 

\begin{figure}[h]
\center
\includegraphics[scale=0.73]{figures/verif_fig_217_save.png}
\caption{\small{Évolution spatiotemporelle du gradient de température (ligne pleine) et conductivité thermique totale (ligne pointillée) près du centre du domaine, pour la solution de la figure \ref{fig:2.16}. Les courbes sont tracées dans une petite partie du domaine près du centre, s'étendant de 0 à 1.5 et aux mêmes pas de temps.}}
\label{fig:2.17}
\end{figure}

Cette figure est encore une fois répliquée exactement, signe que notre programme exécute comme voulu. La variation rapide du gradient de température se produit lorsque cette valeur dépasse $1/\alpha= 1$ dans notre cas.

Maintenant que la vérification du code a été effectuée, une analyse plus poussée de certains phénomènes sera abordée dans la prochaine section.

\section{Résultats et discussion}\label{sec:results}

Cette partie du rapport sera consacrée à l'exploration numérique de certains aspects présentés à la section 2.9.4 des notes de cours.

Le premier sujet abordé est celui de la convergence du confinement du plasma vers le centre du réacteur à mesure que le temps avance. Il est possible de voir sur la figure \ref{fig:2.17} que plus le temps avance, plus la barrière de confinement se rapproche du centre (à x=0). Il est possible de calculer la vitesse de convergence de ce confinement en remarquant que le coefficient de conductivité thermique total $\chi(T)$ chute drastiquement suite au bris de pente au sommet du profil de température. En gardant en mémoire la position où la chute soudaine se produit en fonction du temps écoulé, il est possible de mettre en graphique cette relation. Le tout a été exécuté pour des différentes valeurs d'amplitude du profil gaussien du terme source $H_0$, soit avec $H_0 \in \{10.0,14.4,20.0\}$ en gardant le coefficient $\chi_1$ associé au transport turbulent à $8$, ainsi qu'en faisant varier cette dernière valeur ($\chi_1 \in \{4,8,12,16\}$) en conservant $H_0=14.4$ constant. Les figures \ref{fig:var_h0} et \ref{fig:var_chi1} présentent ces diverses configurations en graphique \textit{log-log}, auquel une courbe de tendance a été ajustée. 

\begin{figure}[h]
\center
\includegraphics[scale=0.73]{figures/num3_H0_good.png}
\caption{\small{Position du bris de pente en fonction du temps pour des simulations à $\chi_1$ constant à 8 en faisant varier l'amplitude du profil gaussien $H_0$.}}
\label{fig:var_h0}
\end{figure}

\begin{figure}[h]
\center
\includegraphics[scale=0.73]{figures/num3_chi1_good.png}
\caption{\small{Position du bris de pente en fonction du temps pour des simulations à $H_0$ constant à 14.4 en faisant varier le coefficient $\chi_1$ associé au transport turbulent $H_0$.}}
\label{fig:var_chi1}
\end{figure}

Les notes de cours proposent une relation de la vitesse en fonction du temps allant en $\sqrt{t}$ en première approximation. Cependant, les graphiques obtenus une légère courbe lorsque tracée en \textit{log-log}, signe que la dépendance de la position du bris de pente ne dépend pas seulement du temps élevé à une certaine puissance. Il est tout de même possible d'approximer cette tendance comme étant linéaire en \textit{log-log} pour trouver approximativement la relation entre la position du bris de pente et le temps écoulé. Pour le cas où $\chi_1$ est constant, la puissance à laquelle t est élevée semble dépendre très faiblement de l'amplitude du profil gaussien du terme source $H_0$, se situant constamment aux alentours de $-0.25$. Cependant, dans le cas où c'est plutôt $H_0$ qui est laissé constant, la puissance de t varie de façon plus importante, passant d'environ $-0.17$ à $-0.28$ pour des valeurs de $\chi_1$ allant de 4 à 16. La vitesse de convergence de la barrière de confinement dépend donc plus du coefficient associé au transport turbulent qu'elle ne dépend de l'amplitude du profil gaussien du terme source. En dérivant les expressions obtenues, une relation moyenne de la vitesse de convergence est approximativement $v(t)\approx c t^{-\frac{5}{4}}$. Cette relation a un sens physique plus approprié que la relation en $\sqrt{t}$, puisque les valeurs de la vitesse vont tendre vers zéro, soit vers une solution à l'équilibre de la barrière de confinement, alors que dans l'autre cas, celles-ci tendaient vers l'infini, signe qu'aucune solution à l'équilibre n'existe, ce qui n'est évidemment pas le cas.

L'effet de la forme du terme source sur la vitesse de convergence de la barrière de confinement a aussi été étudié. En gardant l'amplitude du terme source $H_0$ à 14.4, diverses simulations ont été effectuées en modifiant la largeur de la gaussienne (associée au paramètre $\sigma$) pour des valeurs de $\sigma \in \{0.25,0.5,1.0,2.0\}$. De plus, d'autres simulations ont été menées avec une fonction marche comme terme source, étant nulle partout sauf au centre, où son amplitude était encore une fois de $H_0$ et sa largeur totale était $\in \{0.5,1.0, 2.0, 4.0\}$. Les figures \ref{fig:var_sigma} et \ref{fig:var_heaviside} présentent la position du bris de pente en fonction du temps pour ces termes sources, comme le faisaient les figures \ref{fig:var_h0} et \ref{fig:var_chi1}.

\begin{figure}[h]
\center
\includegraphics[scale=0.73]{figures/num3_sigma_good.png}
\caption{\small{Position du bris de pente en fonction du temps pour des simulations à $H_0$ constant à 14.4 en faisant varier la largeur du profil gaussien $\sigma$.}}
\label{fig:var_h0}
\end{figure}

\begin{figure}[h]
\center
\includegraphics[scale=0.73]{figures/num3_step_good.png}
\caption{\small{Position du bris de pente en fonction du temps pour des simulations à $H_0$ constant à 14.4 en faisant varier la largeur de la fonction marche représentant le terme source.}}
\label{fig:var_chi1}
\end{figure}

La première figure montre une forte dépendance de la vitesse de convergence de la fonction barrière par-rapport à la largeur du profil gaussien du terme source. Cela dit, pour les temps faibles, aucune caractéristique de confinement n'était observable lorsque $\sigma$ était de 0.5, alors ces points n'ont pas été tracés. Les points restants sont donc la queue de la distribution et ont tendance à avoir un ralentissement plus grand que les points lorsque les temps étaient peu élevés. Il y a donc un biais qui a été introduit à cet endroit, puisque la position ne varie pas simplement selon une puissance en fonction du temps. La comparaison entre les courbes à $\sigma=1$ et $\sigma=2$ montre cependant encore une disparité entre les puissances auxquelles t est élevé, signe que la vitesse de convergence dépend bel et bien de la largeur du profil gaussien. En dérivant les expressions trouvées en première approximation, des relations allant de $v(t)\propto t^{-1.07}$ pour $\sigma=0.5$ jusqu'à $v(t)\propto t^{-1.35}$ pour $\sigma=2$ ont été trouvées.

Les dépendances en temps de la position pour un terme source étant une fonction marche sont plutôt semblables. Cependant, le biais étant présent pour la dernière situation en ce qui a trait aux positions aux temps faibles n'est plus présent, puisque la barrière s'établit dès le début de la simulation. Les pentes tracées pour chacun des cas sont très semblables aux pentes tracées dans le cas précédent, alors que la fonction marche d'une demi-largeur de 0.5 possède une relation $v(t)\propto t^{-1.1}$ approximativement, semblable à la valeur de $v(t)\propto t^{-1.07}$ trouvée précédemment pour un profil gaussien avec une demi-largeur à mi-hauteur également de 0.5. Les deux autres cas sont aussi semblables à leur cas homologue pour le profil gaussien, alors que les relations de vitesse sont de $v(t)\propto t^{-1.22}$ et de $v(t)\propto t^{-1.38}$ pour les fonctions marches de demi-largeur de 1.0 et 2.0, respectivement.

La seconde exploration numérique conduite est par-rapport aux valeurs de flux de chaleur en fonction du gradient de température pour une solution à l'équilibre possédant un effet barrière, ainsi qu'une autre solution où aucun effet barrière n'est observé à cause d'une trop faible valeur de l'amplitude du profil gaussien $H_0$ du terme source. Des simulations ont été conduites jusqu'à $t=100$ pour être à l'équilibre pour les différentes combinaisons avec $H_0 \in \{2,20\}$ et $\chi_1 \in \{2,8\}$. Les valeurs de $chi_1$ ont été choisies de sorte qu'ils suivaient deux des courbes tracées à la figure \ref{fig:2.15} et les valeurs de $H_0$ ont été choisies car il y avait effet barrière lorsque $H_0=20$, et cet effet était absent lorsque $H_0=2$. Les résultats sont présentés à la figure \ref{fig:num4}.

\begin{figure}[h]
\center
\includegraphics[scale=0.73]{figures/num4.png}
\caption{\small{Flux de chaleur Q en fonction du gradient de température pour des solutions à l'équilibre avec $H_0$ et 20 ($\chi_1=2$ et $8$), et des solutions ne présentant pas d'effet barrière avec $H_0=2$ pour les mêmes valeurs de $\chi_1$. Les figures pleine résolution et en couleur permettent de mieux déceler les différents points.}}
\label{fig:num4}
\end{figure}

Les points pour les solutions ne présentant pas d'effet barrière sont confinés dans la région où $-dT/dx<0.4$ et restent dans le mode L. Par opposition, les points pour les solutions présentant un effet barrière avec $H_0=20$ s'étalent sur tout le domaine présenté et plusieurs des points de maille se retrouvent dans le mode H, signe qu'il y a confinement du plasma. Il est donc possible de voir directement sur ce graphique si il y a effet barrière pour une simulation donnée sans même voir les graphiques du profil de température ou de l'évolution spatiotemporelle du gradient de température et de conductivité thermique totale, comme ceux présentés aux figures \ref{fig:2.16} et \ref{fig:2.17}.


\section{Programme}
\renewcommand{\baselinestretch}{1.} 
\subsection{Programme principal}
\verbatiminput{tokamak.py}
\subsection{Programme secondaire : Exploration \#3}
\verbatiminput{tokamak_num3.py}
\subsection{Programme secondaire : Exploration \#4}
\verbatiminput{num4_tok.py}


\begin{thebibliography}{1}

\small
\bibitem{notes_chap_2} Charbonneau, P., \textit{PHY3075 - Modélisation numérique en physique, Chapitre 2 : Équations différentielles partielles}, Université de Montréal, Montréal, 2017, 38p.
\end{thebibliography}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Annexes %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\end{document}